<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title></title>
  <script src="https://d3js.org/d3.v6.min.js"></script>
  <div id="my_dataviz"></div>
</head>


<body>
  <script>

    //chart 1
    d3.csv("all.csv").then((data) => {
      console.log(data);

      const width = 800;
      const height = 500;
      const margin = { "top": 30, "right": 10, "bottom": 50, "left": 60 };
      const chartWidth = width - margin.left - margin.right;
      const chartHeight = height - margin.top - margin.bottom

      var svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      let annotations = svg.append("g").attr("id", "annotations");
      let chartArea = svg.append("g").attr("id", "points")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      const ageExtent = d3.extent(data, d => d['artist age']);
      const ageScale = d3.scaleLinear().domain(ageExtent).range([chartHeight, 0])
      let leftAxis = d3.axisLeft(ageScale).tickFormat(d3.format(''));
      let leftGridlines = d3.axisLeft(ageScale)
        .tickSize(-chartWidth - 10)
        .tickFormat("")

      annotations.append("g")
        .attr("class", "y axis")
        .attr("transform", `translate(${margin.left - 10},${margin.top})`)
        .call(leftAxis)
      annotations.append("g")
        .attr("class", "y gridlines")
        .attr("transform", `translate(${margin.left - 10},${margin.top})`)
        .call(leftGridlines);

      const decades = d3.map(data, d => d["decade"]);
      const decadesScale = d3.scalePoint().domain(decades).range([0, chartWidth])
        .padding(0.05);

      let bottomAxis = d3.axisBottom(decadesScale)
      let bottomAxisG = annotations.append("g")
        .attr("class", "x axis")
        .attr("transform", `translate(${margin.left},${chartHeight + margin.top + 10})`)
        .call(bottomAxis);

      //chart title
      svg.append("text")
        .attr("x", width / 2)
        .attr("y", 20)
        .style("text-anchor", "middle")
        .text("Artist Age vs Decades");

      //x axis labels
      svg.append("text")
        .attr("x", width / 2)
        .attr("y", height)
        .style("text-anchor", "middle")
        .text("Decade");

      //y axis label
      svg.append("text")
        .attr("transform", "rotate(-90)")
        .attr("y", 0)
        .attr("x", 0 - (height / 2))
        .attr("dy", "1em")
        .style("text-anchor", "middle")
        .text("Artist Age");


      //create outliers 
      var outliers = []
      data.forEach((d, i) => {
        if (d.decade == "1960" && (d["artist age"] < 17 || d["artist age"] > 33)) {
          outliers.push({
            "year": "1960",
            "age": d["artist age"]
          })
        }
        else if (d.decade == "1970" && (d["artist age"] < 19 || d["artist age"] > 39)) {
          outliers.push({
            "year": "1970",
            "age": d["artist age"]
          })
        }
        else if (d.decade == "1980" && (d["artist age"] < 13 || d["artist age"] > 49)) {
          outliers.push({
            "year": "1980",
            "age": d["artist age"]
          })
        }
        else if (d.decade == "1990" && (d["artist age"] < 12 || d["artist age"] > 44)) {
          outliers.push({
            "year": "1990",
            "age": d["artist age"]
          })
        }
        else if (d.decade == "2000" && (d["artist age"] < 13 || d["artist age"] > 41)) {
          outliers.push({
            "year": "2000",
            "age": d["artist age"]
          })
        }
        else if (d.decade == "2010" && (d["artist age"] < 10 || d["artist age"] > 42)) {
          outliers.push({
            "year": "2010",
            "age": d["artist age"]
          })
        }
      });

      let years = ["1960", "1970", "1980", "1990", "2000", "2010"];

      let whiskers = [{ "lower": 17, "upper": 33 }, { "lower": 19, "upper": 39 }, { "lower": 13, "upper": 49 },
      { "lower": 12, "upper": 44 }, { "lower": 13, "upper": 41 }, { "lower": 10, "upper": 42 }]

      let q1q3 = [{ "q1": 23, "q3": 27, "height": 4 }, { "q1": 26, "q3": 31, "height": 5 }, { "q1": 26, "q3": 35, "height": 9 },
      { "q1": 24, "q3": 32, "height": 8 }, { "q1": 23, "q3": 30, "height": 7 }, { "q1": 22, "q3": 30, "height": 8 }];

      //draw vertical line for whiskers 
      years.forEach((d, i) => {
        chartArea.append("line")
          .attr("x1", decadesScale(d))
          .attr("x2", decadesScale(d))
          .attr("y1", ageScale(whiskers[i]["upper"]))
          .attr("y2", ageScale(whiskers[i]["lower"]))
          .style("stroke", "black")
          .style("stroke-width", 1);
      });

      //draw upper horizontal lines for whiskers
      years.forEach((d, i) => {
        chartArea.append("line")
          .attr("x1", decadesScale(d) - 15)
          .attr("x2", decadesScale(d) + 15)
          .attr("y1", ageScale(whiskers[i]["upper"]))
          .attr("y2", ageScale(whiskers[i]["upper"]))
          .style("stroke", "black")
          .style("stroke-width", 1);
      });

      //draw lower horizontal lines for whiskers
      years.forEach((d, i) => {
        chartArea.append("line")
          .attr("x1", decadesScale(d) - 15)
          .attr("x2", decadesScale(d) + 15)
          .attr("y1", ageScale(whiskers[i]["lower"]))
          .attr("y2", ageScale(whiskers[i]["lower"]))
          .style("stroke", "black")
          .style("stroke-width", 1);
      });

      //draw rectangles
      years.forEach((d, i) => {
        chartArea.append("line")
          .attr("x1", decadesScale(d))
          .attr("x2", decadesScale(d))
          .attr("y1", ageScale(q1q3[i]["q3"]))
          .attr("y2", ageScale(q1q3[i]["q1"]))
          .style("stroke", "darkblue")
          .style("stroke-width", 30);
      });

      //draw outliers 
      outliers.forEach((d, i) => {
        chartArea.append("circle")
          .attr("cx", decadesScale(d["year"]))
          .attr("cy", ageScale(d["age"]))
          .attr("r", 3)
          .style("fill", d => "darkblue")
      })
    });







    //chart 2
    d3.csv("all.csv").then((data) => {
      console.log(data);

      const width = 1000;
      const height = 500;
      const margin = { "top": 10, "right": 10, "bottom": 40, "left": 60 };
      const chartWidth = width - margin.left - margin.right;
      const chartHeight = height - margin.top - margin.bottom

      var svg = d3.select("body")
        .append("svg")
        .attr("width", width)
        .attr("height", height);

      data.forEach((d, i) => {
        d['artist age'] = Number(d['artist age']);
      });

      let annotations = svg.append("g").attr("id", "annotations");
      let chartArea = svg.append("g").attr("id", "points")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

      const ageExtent = d3.extent(data, d => d['artist age']);
      const ageScale = d3.scaleLinear().domain(ageExtent).range([chartHeight, 0])
      let leftAxis = d3.axisLeft(ageScale).tickFormat(d3.format(''));
      let leftGridlines = d3.axisLeft(ageScale)
        .tickSize(-chartWidth - 10)
        .tickFormat("")

      annotations.append("g")
        .attr("class", "y axis")
        .attr("transform", `translate(${margin.left - 10},${margin.top})`)
        .call(leftAxis)
      annotations.append("g")
        .attr("class", "y gridlines")
        .attr("transform", `translate(${margin.left - 10},${margin.top})`)
        .call(leftGridlines);

      const genres = d3.map(data, d => d["altered genre"]);
      const genreScale = d3.scalePoint().domain(genres).range([0, chartWidth])
        .padding(0.05);

      let bottomAxis = d3.axisBottom(genreScale)
      let bottomAxisG = annotations.append("g")
        .attr("class", "x axis")
        .attr("transform", `translate(${margin.left},${chartHeight + margin.top + 10})`)
        .call(bottomAxis);

      // console.log(genres)
      let circles = chartArea.selectAll("circle").data(data)
        .join("circle")
        .attr("cy", d => ageScale(d['artist age']))
        .attr("cx", d => genreScale(d['altered genre']))
        .attr("r", d => 3)
        .attr("opacity", 0.3)
        .style("fill", d => "darkblue")

    });
  </script>

</body>

</html>